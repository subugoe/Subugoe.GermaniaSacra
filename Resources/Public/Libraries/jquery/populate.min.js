$.fn.extend({
	populate_liste: function() {
	
		var $this = $(this);

		url = "http://flow/sub.germania/kloster/jsonList";
		$.getJSON(url, function(response){ 	//alert(response);
//		$.ajax({
//			url = "http://flow/sub.germania/kloster/jsonList";
//			url: 'data/kloester.xml',
//			dataType: 'html',
//		})
//		.done(function(data) { alert(data);
//			var xml = $.parseXML(data);
//			$(xml).find('row').each( function(key, row) {
			$.each(response, function (key, value) { //alert(response[key].kloster);
				var tr = $this.find('tr:eq(1)').clone(true);
				tr.find('td :input').each( function() {
					var name = $(this).attr('name');
					if ( typeof name === 'undefined' ) return;
					name = name.replace('[]', '');
					//alert(name);
					var val = response[key][name];
//					alert(val);
//					var val = $(row).find('field[name="' + name.replace('[]', '') + '"]').text();
					if ( $(this).is('[type=checkbox]') ) {
						return;
					} else if ( $(this).is('select') ) {
						$(this).append('<option>' + val + '</option>');
					} else {
						$(this).val( val );
					}
				});
				$this.append(tr);
			});
			$this.find("textarea").autosize();
		});
		
	
	},
	populate_kloster: function(index) {

		var $this = $(this);
		
		$.ajax({
			url: 'data/kloester.xml',
			dataType: 'html',
		})
		.done(function(data) {
			var xml = $.parseXML(data);
			var row = $(xml).find('row').eq(index);
			$this.find('fieldset :input').each( function() {
				var name = $(this).attr('name');
				if ( typeof name === 'undefined' ) return;
				var val = row.find('field[name="' + name.replace('[]', '') + '"]').text();
				if ( $(this).is('[type=checkbox]') ) {
					return;
				} else if ( $(this).is('select') ) {
					$(this).find('option').remove();
					if ( val ) $(this).append('<option>' + val + '</option>');
				} else {
					$(this).val( val );
				}
			});
			$this.find("textarea").autosize();
			$this.find("input[type=url]").keyup();
		});
	
	}
	
});
