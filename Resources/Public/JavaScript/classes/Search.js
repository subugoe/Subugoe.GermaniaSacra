// Generated by CoffeeScript 1.7.1
germaniaSacra.Search = (function() {
  function Search() {
    this.scope = $('#simple-search, #advanced-search');
    this.advancedSearchRequest = null;
    $('select', this.scope).autocomplete();
    $('#simple-search').submit((function(_this) {
      return function() {
        return _this.simpleSearch();
      };
    })(this));
    $('#advanced-search').submit((function(_this) {
      return function() {
        return _this.advancedSearch();
      };
    })(this));
    $('.reset', this.scope).click((function(_this) {
      return function(e) {
        e.preventDefault();
        return _this.reset(true);
      };
    })(this));
  }

  Search.prototype.simpleSearch = function() {
    var searchString;
    germaniaSacra.message('loading', false);
    germaniaSacra.list.resetFilters();
    searchString = $("#simple-search [name='alle']").val();
    this.advancedSearchRequest = null;
    return germaniaSacra.list.dataTable.search(searchString, true, false).draw();
  };

  Search.prototype.advancedSearch = function() {
    germaniaSacra.message('loading', false);
    germaniaSacra.list.resetFilters();
    this.advancedSearchRequest = $('#advanced-search').serializeArray();
    return germaniaSacra.list.dataTable.ajax.reload();
  };

  Search.prototype.reset = function(redraw) {
    if (redraw == null) {
      redraw = false;
    }
    this.scope.clearForm();
    this.advancedSearchRequest = null;
    germaniaSacra.list.dataTable.search('');
    if (redraw) {
      germaniaSacra.message('loading', false);
      return germaniaSacra.list.dataTable.column(0).search('').draw();
    }
  };

  return Search;

})();
