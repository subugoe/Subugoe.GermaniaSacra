// Generated by CoffeeScript 1.7.1
germaniaSacra.Search = (function() {
  function Search() {
    this.scope = $('#simple-search, #advanced-search');
    $('select', this.scope).autocomplete();
    this.scope.submit(function() {
      var json, search;
      germaniaSacra.message(germaniaSacra.messages.loading, false);
      json = $(this).serializeArray();
      search = $.post('/search', json);
      search.success(function(data) {
        data = $.parseJSON(data);
        if (data.length) {
          $('#uuid-filter').val(data.join('|')).change();
        } else {
          $('#uuid-filter').val('```').change();
        }
        return $('#message').slideUp();
      });
      return search.fail(function(data) {
        $('#message').slideUp();
        return alert('Suche fehlgeschlagen');
      });
    });
    $('.reset', this.scope).click(function(e) {
      e.preventDefault();
      $('#uuid-filter').val('').change();
      return $(this).parents('form').clearForm();
    });
  }

  return Search;

})();
